import { Fragment } from 'react'
import { TimelineWrapper } from './timeline-wrapper'
import { timelineEntries } from './timeline-data'
import { TimelineEntry } from './timeline-entry'

export const metadata = {
  title: 'Whoami',
}

export const dynamic = 'force-static'

<div className="whoami-header">
  <h1 className="text-4xl sm:text-5xl font-bold text-rurikon-700 mb-3 tracking-tight eb-garamond-italic">Whoami</h1>
  <p className="text-rurikon-400 mb-8 text-lg eb-garamond-italic">Security researcher, full-stack developer. I reverse engineer malware, build exploits, and break things professionally.</p>
</div>

<TimelineWrapper>
  {(() => {
    const reversedEntries = [...timelineEntries].reverse()
    const reversedDelays = timelineEntries.map((entry) => entry.delay).reverse()

    return reversedEntries.map((entry, index) => {
      const previousYear = index === 0 ? null : reversedEntries[index - 1]?.year
      const showYearMarker = entry.year !== previousYear
      const key = `${entry.year}-${entry.month}-${index}`
      const entryWithDelay = {
        ...entry,
        delay: reversedDelays[index] ?? entry.delay,
      }

      return (
        <Fragment key={key}>
          {showYearMarker && (
            <div className="timeline-year-marker">
              <span className="year-label">{entry.year}</span>
            </div>
          )}
          <TimelineEntry entry={entryWithDelay} />
        </Fragment>
      )
    })
  })()}
</TimelineWrapper>